<div class = "row">
  <h1><%= @brewery.name %></h1>

  <div class="small-6 large-5 columns">
    <ul>
      <li><%= @brewery.city %></li>
      <li><%= @brewery.street_address %></li>
      <li><%= @brewery.website %></li>
      <li><%= @brewery.phone %></li>
      <li><%= @brewery.hours_of_operation %></li>
    </ul>
  </div>

  <% if (@brewery.latitude || @brewery.longitude) %>
    <div class= "hide-for-small large-7 columns" id="map-container">
      <div id="map-canvas"></div>
    </div>
  <% end %>



</div>

<script type="text/javascript" >
  var geocoder;
  var map;

  function initialize() {
    geocoder = new google.maps.Geocoder();
    codeAddress();
    var latlng = new google.maps.LatLng(-34.397, 150.644);

    var mapOptions = {
      zoom: 6,
      center: latlng
    }
    map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

    var infowindow = new google.maps.InfoWindow();

    var marker = new google.maps.Marker({
     position: new google.maps.LatLng(<%= @brewery.latitude %>, <%= @brewery.longitude %>),
     map: map,
    });

   google.maps.event.addListener(marker, 'mouseover', (function(marker, i) {
     return function() {
       infowindow.setContent(@brewery.name);
       infowindow.open(map, marker);
     }
   })(marker, i));

    }
  }

  function codeAddress() {
    var state = " <%= @brewery.state.name %> ";
    geocoder.geocode( { 'address': state}, function(results, status) {

    var ne = results[0].geometry.viewport.getNorthEast();
    var sw = results[0].geometry.viewport.getSouthWest();

    var bounds = new google.maps.LatLngBounds(sw, ne);
    map.setCenter(bounds.getCenter());
  });
  }

  function loadScript() {
   var script = document.createElement('script');
   script.type = 'text/javascript';
   script.src = 'https://maps.googleapis.com/maps/api/js?v=3.exp' +
       '&signed_in=true&callback=initialize';
   document.body.appendChild(script);
  }

  window.onload = loadScript;


</script>
